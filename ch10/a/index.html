<html>

<head>
<title>MATA65 - Computação Gráfica</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">

<script id="shader-vs" type="x-shader/x-vertex">
	attribute vec3 aVertexPosition;
	attribute vec2 aVertexTexture;

	uniform mat4 uModelMat;
	uniform mat4 uViewMat;
	uniform mat4 uProjMat;
	uniform sampler2D uSampler;
	
	varying vec2 vTextureCoord;
	float height;

	void main(void) {
		height = texture2D(uSampler, vec2(aVertexTexture)).r / 255. * 100. ;

		//vec3 xyz 	= vec3(aVertexPosition.x, aVertexPosition.y, aVertexPosition.z);
		//gl_Position = uProjMat * uViewMat * uModelMat * vec4(xyz,1.0);
		vTextureCoord = aVertexTexture;
		gl_Position = uProjMat * uModelMat * uViewMat * vec4(aVertexPosition.x, height,  aVertexPosition.z, 1.0);

	}
</script>


<script id="shader-fs" type="x-shader/x-fragment">
	precision mediump float;

	uniform sampler2D uSampler;

	varying vec2 vTextureCoord;

	void main(void) {
		vec4 color = texture2D(uSampler, vTextureCoord);
		gl_FragColor = color;
	}
/*	precision mediump float;
		
	uniform sampler2D uSampler;

	varying vec2 vTextureCoord;
	
	void main(void){
		float PI 			= 2.0 * asin(1.0);
		float height 		= 1014.0;
		float width 		= 1014.0;
		float hMax 			= 200.0;
		float hMin 			= 0.0;
		float zenithRad 	= 45.0 * PI / 180.0;
		float azimuthRad 	= radians(270.0);
		float cellsize 		= 256.0;
		float aspectRad 	= 9.0;
		float altura 		= 20.0;
		float slopeRad;
		float a, b, c, d, e, f, g, h, i;

		// vec4 color = texture2D(uSampler, vTextureCoord);
		// gl_FragColor = color;
		// return;
		if((vTextureCoord.s >= 1.0/width && vTextureCoord.s < (width-1.0)/width) && vTextureCoord.t >= 1.0/height && vTextureCoord.t < (height-1.0)/height){

			vec4 aTex = texture2D(uSampler,vec2(vTextureCoord.s-(1.0/width),vTextureCoord.t-(1.0/height)));
			vec4 bTex = texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-(1.0/height)));
			vec4 cTex = texture2D(uSampler,vec2(vTextureCoord.s+(1.0/width),vTextureCoord.t-(1.0/height)));
			vec4 dTex = texture2D(uSampler,vec2(vTextureCoord.s-(1.0/width),vTextureCoord.t));
			vec4 eTex = texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t)); 
			vec4 fTex = texture2D(uSampler,vec2(vTextureCoord.s+(1.0/width),vTextureCoord.t));
			vec4 gTex = texture2D(uSampler,vec2(vTextureCoord.s-(1.0/width),vTextureCoord.t+(1.0/height)));
			vec4 hTex = texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+(1.0/height)));
			vec4 iTex = texture2D(uSampler,vec2(vTextureCoord.s+(1.0/width),vTextureCoord.t+(1.0/height)));	

			a = aTex.r*255.0 + (aTex.g*65280.0) + hMin;
			b = bTex.r*255.0 + (bTex.g*65280.0) + hMin;
			c = cTex.r*255.0 + (cTex.g*65280.0) + hMin;
			d = aTex.r*255.0 + (aTex.g*65280.0) + hMin;
			//e = dTex.r;
			f = fTex.r*255.0 + (fTex.g*65280.0) + hMin;
			g = gTex.r*255.0 + (gTex.g*65280.0) + hMin;
			h = hTex.r*255.0 + (hTex.g*65280.0) + hMin;
			i = iTex.r*255.0 + (iTex.g*65280.0) + hMin;

			float rateOfChangeX = ((c + (2.0*f) + i) - (a + (2.0*d) + g)) / (8.0 * cellsize);
			float rateOfChangeY = ((g + (2.0*h) + i) - (a + (2.0*b) + c)) / (8.0 * cellsize);

			slopeRad = atan(sqrt(pow(rateOfChangeX,2.0) + pow(rateOfChangeY,2.0)));

			if (rateOfChangeX != 0.0){
				aspectRad = atan(rateOfChangeY, -(rateOfChangeX));
				if (aspectRad < 0.0){
					aspectRad = (2.0 * PI) + aspectRad;
				}
			}
			else if (rateOfChangeY > 0.0){
				aspectRad = PI / 2.0;
			}
			else if (rateOfChangeY < 0.0){
				aspectRad =  (2.0 * PI) - (PI / 2.0);
			}

			float hillshade = (sin(zenithRad) * sin(slopeRad)) + (cos(zenithRad) * cos(slopeRad) * sin(azimuthRad - aspectRad));

			vec3 cor = vec3(hillshade,hillshade,hillshade);
			gl_FragColor = vec4(cor, 1.0);
		}else{
			gl_FragColor = vec4(1.0,0.0,0.0,1.0);
		}
	}*/
</script>

<script id="SistVis-vs" type="x-shader/x-vertex">
	attribute vec3 aVertexPosition;
	attribute vec4 aVertexColor;
	
	uniform mat4 uModelMat;
	uniform mat4 uViewMat;
	uniform mat4 uProjMat;
		
	varying vec4 vColor;
		
	void main(void) {
		//uModelMat posiciona o objeto pela coordenadas do mundo
		//uViewMat em relação a sistema de coordenada da camera
		//uProjMat sistema de coordenada da camera para volume canonico
 		gl_Position = uProjMat * uViewMat * uModelMat * vec4(aVertexPosition.xyz, 1.0);
		vColor = aVertexColor;
	}

</script>

<script id="SistVis-fs" type="x-shader/x-fragment">
	precision mediump float;
		
	varying vec4 vColor;
		
	void main(void) {
		gl_FragColor = vColor;
	}
</script>

<script type="text/javascript" src="../../lib/webgl-utils.js"></script>
<script type="text/javascript" src="../../lib/cuon-utils.js"></script>
<script type="text/javascript" src="../../lib/cuon-matrix.js"></script>
<script type="text/javascript" src="../../lib/shaders.js"></script>
<script type="text/javascript" src="../../lib/myOBJParser.js"></script>
<script type="text/javascript" src="../../lib/materialParser.js"></script>
<script type="text/javascript" src="application.js"></script>

</head>

<body onload="webGLStart();">
    <h1>Trabalho 2</h1>
    <p>
	    <script>function goBack(){window.history.back()}</script>
		<button onclick="goBack()">Voltar</button>
	</p>
    <div id="print">
    	<ul>
    		<li>W - Voa pra frente</li>
    		<li>S - Voa pra trás</li>
    		<li>A - YAM esquerda</li>
    		<li>D - YAM direita</li>
    		<li>Seta Esquerdo - Roll esquerda</li>
    		<li>Seta Direito - Roll direita</li>
    		<li>Seta Cima - Pitch pra cima</li>
    		<li>Seta Baixo - Pitch pra Baixo</li>
    		<li>M - Visão do Satelite</li>

    	</ul>
    </div>
    <div id="output"> </div>
    <br/>
    <canvas id="imagem" style="border: none;" width="512" height="512"></canvas>
</body>

</html>
